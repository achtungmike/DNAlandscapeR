shiny::runApp('~/Desktop/Research/DNAlandscapeR')
runApp('~/Desktop/Research/DNAlandscapeR')
runApp('~/Desktop/Research/DNAlandscapeR')
runApp('~/Desktop/Research/DNAlandscapeR')
runApp('~/Desktop/Research/DNAlandscapeR')
runApp('~/Desktop/Research/DNAlandscapeR')
runApp('~/Desktop/Research/DNAlandscapeR')
?plotGenes
runApp('~/Desktop/Research/DNAlandscapeR')
runApp('~/Desktop/Research/DNAlandscapeR')
geneinfo
load("data/GenomeAnnotation/hg19/geneinfo.rda")
setwd("~/Desktop/Research/DNAlandscapeR")
setwd("~/Desktop/Research/DNAlandscapeR")
load("data/GenomeAnnotation/hg19/geneinfo.rda")
head(geneinfo)
addinexamples:::reformatAddin()
core_chrom <- paste("chr", seq(1,22,1), sep = "")
core_chrom <- c(core_chrom, "chrX")
chr <- core_chrom
# Human all genes
vals = list(chr, "protein_coding")
mart = useMart(biomart = "ENSEMBL_MART_ENSEMBL", host = "grch37.ensembl.org",
path = "/biomart/martservice", dataset = "hsapiens_gene_ensembl")
geneinfo = getBM(attributes = c("chromosome_name", "start_position",
"end_position", "external_gene_name", "strand"), filters = c("chromosome_name",
"biotype"), values = vals, mart = mart)
head(geneinfo)
core_chrom <- seq(1,22,1)
core_chrom <- c(core_chrom, "X")
chr <- core_chrom
# Human all genes
vals = list(chr, "protein_coding")
mart = useMart(biomart = "ENSEMBL_MART_ENSEMBL", host = "grch37.ensembl.org",
path = "/biomart/martservice", dataset = "hsapiens_gene_ensembl")
geneinfo = getBM(attributes = c("chromosome_name", "start_position",
"end_position", "external_gene_name", "strand"), filters = c("chromosome_name",
"biotype"), values = vals, mart = mart)
head(geneinfo)
colnames(geneinfo) <- c("chr", "start", "end", "id", "strand")
raw <- makeGRangesFromDataFrame(geneinfo, keep.extra.columns = TRUE,
ignore.strand = TRUE, seqnames.field = c("chr"), start.field = "start",
end.field = c("end"), starts.in.df.are.0based = FALSE)
raw <- makeGRangesFromDataFrame(geneinfo, keep.extra.columns = TRUE,
ignore.strand = TRUE, seqnames.field = c("chr"), start.field = "start",
end.field = c("end"), strand.field = "strand", starts.in.df.are.0based = FALSE)
gr <- sortSeqlevels(raw)
gr <- sort(gr)
geneinfo$score <- "."
vals = list(chr, "protein_coding")
mart = useMart(biomart = "ENSEMBL_MART_ENSEMBL", host = "grch37.ensembl.org",
path = "/biomart/martservice", dataset = "hsapiens_gene_ensembl")
geneinfo = getBM(attributes = c("chromosome_name", "start_position",
"end_position", "external_gene_name", "strand"), filters = c("chromosome_name",
"biotype"), values = vals, mart = mart)
colnames(geneinfo) <- c("chr", "start", "end", "id", "strand")
geneinfo$score <- "."
head(geneinfo)
vals = list(chr, "protein_coding")
mart = useMart(biomart = "ENSEMBL_MART_ENSEMBL", host = "grch37.ensembl.org",
path = "/biomart/martservice", dataset = "hsapiens_gene_ensembl")
geneinfo = getBM(attributes = c("chromosome_name", "start_position",
"end_position", "external_gene_name", "strand"), filters = c("chromosome_name",
"biotype"), values = vals, mart = mart)
colnames(geneinfo) <- c("chrom", "start", "end", "gene", "strand")
geneinfo$score <- "."
head(geneinfo)
geneinfo <- geneinfo[,c(1,2,3,4,6,5)]
save(geneinfo, "geneinfo.rda")
save(geneinfo, file="geneinfo.rda")
runApp()
load("data/GenomeAnnotation/hg19/geneinfo.rda")
head(geneinfo)
geneinfo <- geneinfo[geneinfo$chrom == chrom & geneinfo$start > start & geneinfo$stop < end,]
region
chr9reg <- GRanges(seqnames=c("9"),ranges=IRanges(start=c(0129720),end=c(23277926)))
chr9reg
chrom <- as.character(seqnames(y))
chromchr <- paste(c("chr", as.character(chrom)), collapse = "")
start <- as.integer(start(ranges(range(y))))
end <- as.integer(end(ranges(range(y))))
y <- chr9reg
chrom <- as.character(seqnames(y))
chromchr <- paste(c("chr", as.character(chrom)), collapse = "")
start <- as.integer(start(ranges(range(y))))
end <- as.integer(end(ranges(range(y))))
geneinfo <- geneinfo[geneinfo$chrom == chrom & geneinfo$start > start & geneinfo$stop < end,]
head(geneinfo)
chrom
load("data/GenomeAnnotation/hg19/geneinfo.rda")
head(geneinfo)
core_chrom <- seq(1,22,1)
core_chrom <- c(core_chrom, "X")
chr <- core_chrom
# Human all genes
vals = list(chr, "protein_coding")
mart = useMart(biomart = "ENSEMBL_MART_ENSEMBL", host = "grch37.ensembl.org",
path = "/biomart/martservice", dataset = "hsapiens_gene_ensembl")
geneinfo = getBM(attributes = c("chromosome_name", "start_position",
"end_position", "external_gene_name", "strand"), filters = c("chromosome_name",
"biotype"), values = vals, mart = mart)
colnames(geneinfo) <- c("chrom", "start", "stop", "gene", "strand")
geneinfo$score <- "."
geneinfo <- geneinfo[,c(1,2,3,4,6,5)]
save(geneinfo, file="data/GenomeAnnotation/hg19/geneinfo.rda")
load("data/GenomeAnnotation/hg19/geneinfo.rda")
geneinfo <- geneinfo[geneinfo$chrom == chrom & geneinfo$start > start & geneinfo$stop < end,]
head(geneinfo)
runApp()
chromend = end, bheight = 0.1, plotgenetype = "box",
vals = list(chr)
mart = useMart(biomart="ENSEMBL_MART_ENSEMBL", host="grch37.ensembl.org",
path="/biomart/martservice" ,dataset="hsapiens_gene_ensembl")
geneinfo = getBM(attributes = c("chromosome_name", "start_position", "end_position",
"external_gene_name", "strand"), filters = c("chromosome_name"),
values = vals, mart = mart)
head(geneinfo)
dim(geneinfo)
load("data/GenomeAnnotation/hg19/geneinfo-exon.rda")
head(geneinfo)
dim(geneinfo)
chr
vals = list(chr)
mart = useMart(biomart="ENSEMBL_MART_ENSEMBL", host="grch37.ensembl.org",
path="/biomart/martservice" ,dataset="hsapiens_gene_ensembl")
geneinfo = getBM(attributes = c("chromosome_name", "exon_chrom_start", "exon_chrom_end", "external_gene_name",
"strand"), mart = mart, values = vals)
dim(geneinfo)
head(geneinfo)
vals
chr
tail(geneinfo)
unique(geneinfo@chromosome_name)
unique(geneinfo$chromosome_name)
colnames(geneinfo) <- c("chrom", "start", "stop", "gene", "strand")
g <- geneinfo[geneinfo$chrom %in% chr,]
dim(g)
head(g)
geneinfo <- geneinfo[geneinfo$chrom %in% chr,]
geneinfo$score <- "."
geneinfo <- geneinfo[,c(1,2,3,4,6,5)]
head(geneinfo)
row.names(geneinfo) <- NULL
head(geneinfo)
save(geneinfo, file="data/GenomeAnnotation/hg19/geneinfo-exon.rda")
load("data/GenomeAnnotation/mm9/geneinfo.rda")
head(geneinfo)
load("data/GenomeAnnotation/mm9/geneinfo-exon.rda")
head(geneinfo)
dim(geneinfo)
head(geneinfo)
load("data/GenomeAnnotation/mm9/geneinfo-exon.rda")
load("data/GenomeAnnotation/mm9/geneinfo.rda")
dim(geneinfo)
core_chrom <- seq(1,19,1)
core_chrom <- c(core_chrom, "X")
chr <- core_chrom
# Mouse protein coding
vals = list(chr, "protein_coding")
mart = useMart(host='may2012.archive.ensembl.org', biomart='ENSEMBL_MART_ENSEMBL',
dataset = "mmusculus_gene_ensembl")
geneinfo = getBM(attributes = c("chromosome_name", "start_position",
"end_position", "external_gene_id", "strand"), filters = c("chromosome_name",
"biotype"), values = vals, mart = mart)
head(geneinfo)
tail(geneinfo)
colnames(geneinfo) <- c("chrom", "start", "stop", "gene", "strand")
geneinfo$score <- "."
geneinfo <- geneinfo[,c(1,2,3,4,6,5)]
save(geneinfo, file="data/GenomeAnnotation/mm9/geneinfo.rda")
vals = list(chr, "protein_coding")
mart = useMart(host='may2012.archive.ensembl.org', biomart='ENSEMBL_MART_ENSEMBL',
dataset = "mmusculus_gene_ensembl")
geneinfo = getBM(attributes = c("chromosome_name", "exon_chrom_start",
"exon_chrom_end", "external_gene_id", "strand"), filters = c("chromosome_name"), values = vals, mart = mart)
dim(geneinfo)
head(geneinfo)
colnames(geneinfo) <- c("chrom", "start", "stop", "gene", "strand")
geneinfo <- geneinfo[geneinfo$chrom %in% chr,]
geneinfo$score <- "."
geneinfo <- geneinfo[,c(1,2,3,4,6,5)]
row.names(geneinfo) <- NULL
save(geneinfo, file="data/GenomeAnnotation/mm9/geneinfo-exon.rda")
head(geneinfo)
dim(geneinfo)
save(geneinfo, file="data/GenomeAnnotation/mm9/geneinfo-exon.rda")
runApp()
runApp()
runApp()
runApp()
runApp()
packrat::snapshot()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
