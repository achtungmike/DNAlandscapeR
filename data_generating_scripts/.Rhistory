head(a)
esc_anno <- vf_anno[,c(1,2,3,4)]
library(diffloop)
load("/Users/lareauc/Desktop/Research/AryeeResearch/sarah-qual/output/valid_full-v1.0.rda")
ctcf <- rmchr(padGRanges(bedToGRanges("/Users/lareauc/Desktop/Research/AryeeResearch/sarah-qual/input/CTCF-np_peaks.narrowPeak"), pad = 1000))
h3k27ac <- rmchr(padGRanges(bedToGRanges("/Users/lareauc/Desktop/Research/AryeeResearch/sarah-qual/input/H3K27ac-np_peaks.narrowPeak"), pad = 1000))
promoter <- padGRanges(getHumanTSS(), pad = 1000)
vf_anno <- annotateLoops(valid_full, ctcf, h3k27ac, promoter)
esc_anno <- vf_anno[,c(1,2,3,4)]
esc_anno@colData$groups <- c("naive", "naive", "primed", "primed")
esc_res <- quickAssoc(esc_anno)
t <- topLoops(esc_res, FDR = 0.01)
head(t)
t
sdf <- summary(t)
sdf
sdf
write.table(format(sdf, digits = 3), row.names = FALSE, quote = FALSE, sep = "\t")
write.table(format(sdf, digits = 3), file = "esc-differential-loops.txt", row.names = FALSE, quote = FALSE, sep = "\t")
